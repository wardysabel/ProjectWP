jQuery(function(f){"use strict";if("undefined"==typeof everest_forms_params)return!1;({$everest_form:f("form.everest-form"),init:function(){this.init_inputMask(),this.init_mailcheck(),this.init_datepicker(),this.load_validation(),this.submission_scroll(),this.randomize_elements(),this.$everest_form.on("input validate change",".input-text, select, input:checkbox, input:radio",this.validate_field)},init_inputMask:function(){"undefined"!=typeof f.fn.inputmask&&f(".evf-masked-input").inputmask()},init_mailcheck:function(){"undefined"!=typeof f.fn.mailcheck&&everest_forms_params.mailcheck_enabled&&(0<everest_forms_params.mailcheck_domains.length&&(Mailcheck.defaultDomains=Mailcheck.defaultDomains.concat(everest_forms_params.mailcheck_domains)),0<everest_forms_params.mailcheck_toplevel_domains.length&&(Mailcheck.defaultTopLevelDomains=Mailcheck.defaultTopLevelDomains.concat(everest_forms_params.mailcheck_toplevel_domains)),f(document).on("blur",".evf-field-email input",function(){var e=f(this),s=e.attr("id");e.mailcheck({suggested:function(e,a){f("#"+s+"_suggestion").remove();var i=everest_forms_params.i18n_messages_email_suggestion.replace("{suggestion}",'<a href="#" class="mailcheck-suggestion" data-id="'+s+'" title="'+everest_forms_params.i18n_messages_email_suggestion_title+'">'+a.full+"</a>");f(e).after('<label class="evf-error mailcheck-error" id="'+s+'_suggestion">'+i+"</label>")},empty:function(){f("#"+s+"_suggestion").remove()}})}),f(document).on("click",".evf-field-email .mailcheck-suggestion",function(e){var a=f(this),i=a.attr("data-id");e.preventDefault(),f("#"+i).val(a.text()),a.parent().remove()}))},init_datepicker:function(){0<f(".evf-field-date-time").length&&f(".flatpickr-field").each(function(){var e=5,a=f(this).data();switch(a.dateTime){case"date":f(this).flatpickr({disableMobile:!0,mode:a.mode,minDate:a.minDate,maxDate:a.maxDate,dateFormat:a.dateFormat});break;case"time":undefined!==a.timeInterval&&(e=parseInt(a.timeInterval,10)),f(this).flatpickr({enableTime:!0,noCalendar:!0,minuteIncrement:e,dateFormat:a.dateFormat,disableMobile:!0,time_24hr:a.dateFormat.includes("H:i")});break;case"date-time":undefined!==a.timeInterval&&(e=parseInt(a.timeInterval,10)),f(this).flatpickr({enableTime:!0,noCalendar:!1,disableMobile:!0,mode:a.mode,minDate:a.minDate,maxDate:a.maxDate,minuteIncrement:e,dateFormat:a.dateFormat,time_24hr:a.dateFormat.includes("H:i")})}})},load_validation:function(){if("undefined"==typeof f.fn.validate)return!1;f(".evf-field-url input[type=url]").change(function(){var e=f(this).val();if(!e)return!1;"http://"!==e.substr(0,7)&&"https://"!==e.substr(0,8)&&f(this).val("http://"+e)}),f.extend(f.validator.messages,{required:everest_forms_params.i18n_messages_required,url:everest_forms_params.i18n_messages_url,email:everest_forms_params.i18n_messages_email,number:everest_forms_params.i18n_messages_number}),f.validator.methods.email=function(e,a){var i=new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i);return this.optional(a)||i.test(e)},f.validator.addMethod("confirm",function(e,a,i){return f.validator.methods.equalTo.call(this,e,a,i)},everest_forms_params.i18n_messages_confirm),f.validator.addMethod("check-limit",function(e,a){var i=f(a).closest("ul"),s=i.find('input[type="checkbox"]:checked'),t=parseInt(i.attr("data-choice-limit")||0,10);return 0===t||s.length<=t},function(e,a){var i=parseInt(f(a).closest("ul").attr("data-choice-limit")||0,10);return everest_forms_params.i18n_messages_check_limit.replace("{#}",i)}),this.$everest_form.each(function(){var e=f(this),o={};f(".evf-field").each(function(){var e=f(this).closest("form").data("formid"),a=f(this).data("field-id"),i=f(this).data("required-field-message"),s="everest_forms[form_fields]["+a+"]";if(f(this).is(".evf-field-payment-single"))f(this).find(".evf-payment-price").is(".evf-payment-user-input")||(f(this).find(".evf-payment-price").attr("required",!1),i=null);else if(f(this).is(".evf-field-checkbox, .evf-field-payment-checkbox"))s+="[]";else if(f(this).is(".evf-field-file-upload, .evf-field-image-upload"))s="evf_"+e+"_"+a;else if(f(this).is(".evf-field-signature"))s="everest_forms[form_fields]["+a+"][signature_image]";else if(f(this).is(".evf-field-phone"))s+="[phone_field]";else if(f(this).is(".evf-field-email")||f(this).is(".evf-field-password"))o[s="everest_forms[form_fields]["+a+"]"]={required:i},o[s="everest_forms[form_fields]["+a+"][primary]"]={required:i},o[s="everest_forms[form_fields]["+a+"][secondary]"]={required:i},i=null;else if(f(this).is(".evf-field-address")){for(var t={address1:f(this).data("required-field-message-address1"),city:f(this).data("required-field-message-city"),state:f(this).data("required-field-message-state"),postal:f(this).data("required-field-message-postal"),country:f(this).data("required-field-message-country")},r=Object.keys(t),l=0;l<r.length;l++){var d=r[l];i=t[r[l]];o[s="everest_forms[form_fields]["+a+"]["+d+"]"]={required:i}}i=null}else if(f(this).is(".evf-field-likert")){var n=f(this).data("row-keys");t={};if(n&&Array.isArray(n)){for(l=0;l<n.length;l++){var u=n[l];t[u]=f(this).data("required-field-message-"+u)}for(l=0;l<n.length;l++)i=t[n[l]],s="everest_forms[form_fields]["+a+"]["+n[l]+"]",o[s]={required:i}}i=null}i&&(o[s]={required:i})}),e.validate({messages:o,ignore:"",errorClass:"evf-error",validClass:"evf-valid",errorPlacement:function(e,a){a.closest(".evf-field").is(".evf-field-scale-rating")?a.closest(".evf-field").find(".everest-forms-field-scale-rating").after(e):"radio"===a.attr("type")||"checkbox"===a.attr("type")?a.hasClass("everest-forms-likert-field-option")?a.closest("tr").children("th").append(e):(a.closest(".evf-field-checkbox").find("label.evf-error").remove(),a.parent().parent().parent().append(e)):a.is("select")&&a.attr("class").match(/date-month|date-day|date-year/)?0===a.parent().find("label.evf-error:visible").length&&a.parent().find("select:last").after(e):a.hasClass("evf-smart-phone-field")||a.hasClass("everest-forms-field-password-primary")||a.hasClass("everest-forms-field-password-secondary")?a.parent().after(e):e.insertAfter(a)},highlight:function(e,a,i){var s=f(e),t=s.closest(".form-row"),r=s.attr("name");"radio"===s.attr("type")||"checkbox"===s.attr("type")?t.find("input[name='"+r+"']").addClass(a).removeClass(i):s.addClass(a).removeClass(i),t.removeClass("everest-forms-validated").addClass("everest-forms-invalid evf-has-error")},unhighlight:function(e,a,i){var s=f(e),t=s.closest(".form-row"),r=s.attr("name");"radio"===s.attr("type")||"checkbox"===s.attr("type")?t.find("input[name='"+r+"']").addClass(i).removeClass(a):s.addClass(i).removeClass(a),t.removeClass("evf-has-error")},submitHandler:function(e){var a=f(e),i=a.find(".evf-submit"),s=i.data("process-text");s&&i.text(s).prop("disabled",!0),1!==a.data("ajax_submission")&&e.submit()},onkeyup:function(e,a){f(e).hasClass("everest-forms-novalidate-onkeyup")||9===a.which&&""===this.elementValue(e)||-1!==f.inArray(a.keyCode,[16,17,18,20,35,36,37,38,39,40,45,144,225])||(e.name in this.submitted||e.name in this.invalid)&&this.element(e)},onfocusout:function(e){var a=!1;f(e).hasClass("everest-forms-novalidate-onkeyup")&&!e.value&&(a=!0),this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||(a=!0),a&&this.element(e)},onclick:function(e){var a=!1;"checkbox"===(e||{}).type?(f(e).closest(".evf-field-checkbox").find("label.evf-error").remove(),a=!0):f(e).valid(),a&&this.element(e)}})})},validate_field:function(e){var a=f(this),i=a.closest(".form-row"),s=!0,t=i.is(".validate-required"),r=i.is(".validate-email"),l=e.type;if(i.hasClass("evf-field-address")||i.hasClass("evf-field-payment-single"))0===i.find("input.evf-error").length&&i.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email").addClass("everest-forms-validated");else if("input"===l&&i.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email everest-forms-validated"),"validate"===l||"change"===l){if(t&&(a.hasClass("everest-forms-likert-field-option")?0<i.find("input.evf-error").length&&(i.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-required-field"),s=!1):("checkbox"===a.attr("type")&&0===i.find("input:checked").length||""===a.val())&&(i.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-required-field"),s=!1)),r)if(a.val())new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(a.val())||(i.removeClass("everest-forms-validated").addClass("everest-forms-invalid everest-forms-invalid-email"),s=!1);s&&i.removeClass("everest-forms-invalid everest-forms-invalid-required-field everest-forms-invalid-email").addClass("everest-forms-validated")}},submission_scroll:function(){f("div.everest-forms-submission-scroll").length&&f("html,body").animate({scrollTop:f("div.everest-forms-submission-scroll").offset().top-100},1e3)},randomize_elements:function(){f(".everest-forms-randomize").each(function(){for(var e=f(this),a=e.children();a.length;)e.append(a.splice(Math.floor(Math.random()*a.length),1)[0])})}}).init()});